Windows IP地址管理器 - 更新说明
=====================================

版本: v2.1.1
更新日期: 2025-08-11
构建时间: 17:45

=====================================
版本历史
=====================================

v2.1.1 (2025-08-11) - 风扇转速渐变显示版本
-------------------------------------
新增/变更:
- 新增风扇转速渐变显示功能：为CPU和GPU风扇转速添加颜色渐变徽章，类似温度显示效果
- 风扇转速颜色规则：<800 RPM(绿色)、800-1500 RPM(黄色)、1500-2500 RPM(橙色)、>2500 RPM(红色)
- 优化硬件信息显示：CPU和GPU卡片现在同时显示温度和风扇转速徽章，提供更直观的硬件状态监控
- 新增风扇转速样式：FanGreen、FanYellow、FanOrange、FanRed四种渐变样式，提升视觉效果
- 完善LibreHardwareMonitor集成：修复风扇传感器识别问题，支持更多风扇传感器名称匹配

技术改进:
- 新增_fan_badge方法：为风扇转速提供颜色渐变逻辑，类似温度徽章机制
- 扩展样式系统：添加四种风扇转速专用样式，提供更好的视觉区分
- 优化传感器匹配：增加更多风扇传感器名称关键词，提高识别准确率
- 改进硬件信息显示：CPU和GPU卡片现在支持多个徽章同时显示

v2.1.0 (2025-08-11) - 任务栏图标修复版本
-------------------------------------
新增/变更:
- 修复Windows任务栏图标显示问题：解决添加系统托盘功能后任务栏图标不显示的问题
- 优化图标设置机制：统一使用ip_manager.ico作为主要图标文件，添加窗口类图标设置
- 改进系统托盘功能：确保托盘图标和任务栏图标都能正确显示
- 增强图标兼容性：支持多种图标文件格式和尺寸，提供更好的显示效果
- 完善EXE打包配置：优化PyInstaller配置，确保打包后的EXE文件图标正确显示

技术改进:
- 添加窗口类图标设置：使用ctypes直接设置窗口类图标，确保任务栏正确显示
- 统一图标文件命名：使用ip_manager.ico作为主要图标文件
- 优化图标加载机制：支持多种图标格式和尺寸的自动选择
- 改进EXE打包配置：确保图标文件正确嵌入到可执行文件中

v2.0.9 (2025-08-11) - 工具区域滚动条优化
-------------------------------------
新增/变更:
- 为工具区域添加滚动条功能：解决窗口变小时内容显示不全的问题
- 优化工具区域布局：使用Canvas+Scrollbar实现可滚动容器
- 支持鼠标滚轮操作：用户可以通过滚轮或滚动条浏览所有工具功能
- 保持界面整洁性：滚动条只在需要时显示，不影响正常使用体验

v2.0.8 (2025-08-11) - 分段按钮布局优化
-------------------------------------
新增/变更:
- 最终修复分段按钮文字居中问题：添加sticky=tk.EW参数和toolbar列权重配置
- 优化按钮布局：为toolbar的5列设置equal weight，确保按钮均匀分布
- 完善布局系统：按钮现在能够自适应宽度，文字居中显示效果更佳

v2.0.7 (2025-08-11) - 分段按钮文字居中修复
-------------------------------------
新增/变更:
- 正确修复分段按钮文字居中问题：发现程序使用自定义分段按钮而非notebook选项卡，修改Segment.TButton和SegmentSelected.TButton样式
- 添加anchor='center'和justify='center'属性：确保"硬件信息"等按钮文字完全居中显示
- 解决根本问题：之前错误地修改了TNotebook.Tab样式，实际应该修改分段按钮样式

v2.0.6 (2025-08-11) - 选项卡标题居中修复
-------------------------------------
新增/变更:
- 彻底修复选项卡标题居中问题：在notebook创建时立即设置样式，确保TNotebook.Tab样式正确应用
- 增强样式配置：添加justify='center'和更完整的样式映射，确保文字完全居中
- 优化样式应用时机：在notebook创建后立即应用样式，避免样式设置延迟导致的问题

v2.0.5 (2025-08-11) - 界面优化修复
-------------------------------------
新增/变更:
- 修复选项卡标题居中问题：为TNotebook.Tab样式添加anchor='center'属性，确保所有选项卡标题文字居中显示
- 优化选项卡样式：统一选项卡标题的字体大小和内边距，提升界面美观度
- 改进用户体验：修复硬件信息等选项卡标题显示不居中的问题

v2.0.4 (2025-08-11) - 第一次关闭询问优化
-------------------------------------
新增/变更:
- 优化系统托盘关闭逻辑：第一次关闭时询问用户是关闭程序还是最小化到系统托盘
- 新增关闭确认对话框：提供"是(最小化到托盘)/否(关闭程序)/取消(返回程序)"三个选项
- 改进用户体验：避免用户误操作关闭程序，提供更友好的关闭确认机制
- 智能状态管理：使用first_close_asked标志确保只在第一次关闭时询问

v2.0.3 (2025-08-11) - 设备和打印机快捷访问
-------------------------------------
新增/变更:
- 新增"设备和打印机"按钮：在网卡控制区域添加快捷按钮，点击即可打开Windows设备和打印机管理界面
- 优化网卡控制界面布局：采用3列布局重新设计，第一行放置禁用/启用/重置按钮，第二行放置控制面板和设备和打印机按钮
- 改进按钮布局：使用sticky=tk.EW让按钮自适应宽度，提供更好的视觉效果

v2.0.2 (2025-08-11) - 网络控制面板快捷访问
-------------------------------------
新增/变更:
- 新增"一键打开网络控制面板"按钮：在网卡控制区域添加快捷按钮，点击即可打开Windows网络连接控制面板（ncpa.cpl）
- 优化网卡控制界面布局：新增按钮与重置网络按钮并排显示，提供更便捷的网络管理体验

v2.0.1 (2025-08-11) - 系统托盘与网络状态优化
-------------------------------------
新增/变更:
- 新增系统托盘功能：点击右上角X最小化到任务栏，支持单击托盘图标显示窗口，右键菜单包含"显示主窗口"和"退出"
- 优化网络适配器状态显示：准确区分"已禁用"、"未连接"、"已连接"、"连接中"等状态
- 修复网络适配器状态判断逻辑：使用NetConnectionStatus属性进行精确状态判断
- 更新网卡控制功能：禁用/启用网卡功能使用统一的状态判断逻辑
- 优化UI显示：修复获取网络信息时的界面布局问题，使用异步处理避免UI阻塞
- 默认窗口大小调整为 820×750，提供更好的显示体验

v2.0.0 (2025-08-09) - 硬件信息与现代化界面
-------------------------------------
新增/变更:
- 新增"硬件信息"子界面（CPU/显卡/内存/硬盘/主板/显示器/系统信息），卡片式布局、渐变标题
- 集成 OpenHardwareMonitor（DLL/WMI）：显示温度与风扇转速；提供实时刷新开关与刷新间隔
- 新增"复制信息"按钮：一键复制全部硬件信息文本
- 显示器详情：名称、厂商、序列号、物理尺寸、分辨率、刷新率
- UI 现代化：浅色主题、按钮与分段样式重构、标题置中
- 默认窗口大小调整为 600×453（进一步优化1920×1080显示器适配）

v1.3.5 (2025-08-09) - 诊断工具增强
-------------------------------------
新增/变更:
- "网络诊断"新增"网络追踪（tracert）"，默认目标 www.baidu.com，并在新 CMD 窗口执行
- 与"内网测试（ping）/网络测试（ping）"统一布局与样式
- 默认窗口大小调整为 1024×680

v1.3.4 (2025-08-09) - 权限与体验优化
-------------------------------------
新增/变更:
- 启动时自动尝试管理员提权（UAC），避免权限相关功能失败
- 防火墙 ping 规则智能判断：优先启用，不存在则自动创建，并验证启用状态；按钮改为"开/关防火墙ping"，根据当前状态提示启用/禁用
- 防火墙规则采用自有命名，提升兼容性：
  - 允许：IPM_ICMPv4_Echo_Request_Allow、IPM_ICMPv4_Echo_Reply_Allow
  - 阻止：IPM_ICMPv4_Echo_Request_Block、IPM_ICMPv4_Echo_Reply_Block
- Win11 自动登录开关：保存后自动打开 netplwiz，便于快速完成配置

v1.3.3 (2025-08-09) - 工具与稳定性增强
-------------------------------------
新增/变更:
- 工具页重构为"网络诊断/系统工具"分组，布局更清晰
- 新增快速工具：刷新DNS、IP释放、IP续租、Winsock重置、打开防火墙ping
- "一键清理浏览器缓存"纳入系统工具分组，带进度条且不清除账号密码
- 统一子进程调用为静默执行，修复 UnicodeDecodeError (gbk) 异常
- 网络测试区域按钮与输入框对齐优化

v1.3.2 (2025-08-09) - 图标与网络测试增强
-------------------------------------
新功能/变更:
- 更换应用图标为可爱的二次元风格，并同步更新窗口左上角图标
- 右侧布局进一步收窄，左侧保持不变
- 新增网络测试工具：
  - 内网测试（ping）：默认取所选网卡的网关地址，并在新cmd窗口执行 `ping <网关> -t`
  - 网络测试（ping）：默认 `www.baidu.com`，在新cmd窗口执行 `ping 目标 -t`
- 将"IP操作"按钮组集成到"IP配置"和"额外IP地址"页底部

v1.3.1 (2025-08-08) - IP验证优化版本
-------------------------------------
新功能:
- 完善IP地址验证功能
- 实时验证IP地址、子网掩码、网关、DNS
- 每个段严格限制在0-255范围内
- 提供详细的错误提示信息
- 优化用户体验和输入安全性

技术改进:
- 新增validate_ip_address()函数，提供详细验证
- 改进validate_ipv4_entry()函数，实时检查数值范围
- 优化set_static_ip()函数，增加完整验证流程
- 更新get_extra_ips()函数，使用新的验证方法

验证规则:
- IP地址格式：x.x.x.x（4个段）
- 数值范围：每个段0-255
- 实时验证：输入时检查格式和范围
- 详细错误提示：明确指出错误字段和具体数值

v1.3.0 (2025-08-08) - 界面美化版本
-------------------------------------
新功能:
- 界面字体全面放大（9号→11号）
- 标题字体增大（16号→18号）
- 修复按钮悬停时颜色变化问题
- 优化整体视觉效果和可读性

技术改进:
- 使用style.map()方法固定按钮悬停颜色
- 统一字体大小提升用户体验
- 增强界面可读性和美观性

v1.0.0 (2025-08-08) - 初始版本
-------------------------------------
核心功能:
- Windows IP地址管理功能
- 网络适配器控制（启用/禁用）
- 静态IP配置
- DHCP自动配置
- 多IP地址配置（最多5个额外IP）
- 网络重置功能
- 版本号显示

界面特性:
- 按钮颜色系统（10种不同颜色）
- IP信息文本框美化
- 状态栏美化
- 响应式布局设计

技术特性:
- 使用WMI进行网络配置管理
- 支持IPv4和IPv6地址
- 图形化界面，操作简便
- 单文件exe打包
- 管理员权限检测

=====================================
界面美化详情
=====================================

按钮颜色系统:
- 刷新按钮：绿色 (#4CAF50)
- 设置静态IP：蓝色 (#2196F3)
- 设置DHCP：橙色 (#FF9800)
- 刷新信息：紫色 (#9C27B0)
- 导出配置：蓝灰色 (#607D8B)
- 添加IP：绿色 (#4CAF50)
- 清空/删除：红色 (#F44336)
- 禁用网卡：深橙色 (#FF5722)
- 启用网卡：绿色 (#4CAF50)
- 重置网络：粉红色 (#E91E63)

文本框美化:
- 背景色：浅灰色 (#F5F5F5)
- 文字颜色：深灰色 (#333333)
- 选中背景：蓝色 (#2196F3)
- 选中文字：白色

状态栏美化:
- 背景色：浅蓝色 (#E3F2FD)
- 文字颜色：深蓝色 (#1976D2)

=====================================
使用说明
=====================================

1. 运行程序需要管理员权限
2. 选择网络适配器后可以查看当前IP信息
3. 可以设置静态IP或DHCP自动配置
4. 支持添加多个额外IP地址
5. 可以启用/禁用网络适配器
6. 支持网络重置功能

=====================================
已知问题
=====================================

- 需要管理员权限才能执行网络配置操作
- 某些功能在非管理员权限下会显示警告

=====================================
技术支持
=====================================

如有问题或建议，请联系开发团队。

=====================================
文件信息
=====================================

程序文件: IP管理器.exe
版本文件: version.py
更新日志: CHANGELOG.md
更新说明: 更新说明.txt

最后更新: 2025-08-11 16:30 