#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
版本信息管理文件
"""

# 版本信息
VERSION = "v2.1.1"
BUILD_DATE = "2025-08-11"
BUILD_TIME = "17:45"

# 版本描述
VERSION_DESCRIPTION = "Windows IP地址管理器 v2.1.1 - 风扇转速渐变显示版本"

# 更新日志
CHANGELOG = """
v2.1.1 (2025-08-11)
- 新增风扇转速渐变显示功能：为CPU和GPU风扇转速添加颜色渐变徽章，类似温度显示效果
- 风扇转速颜色规则：<800 RPM(绿色)、800-1500 RPM(黄色)、1500-2500 RPM(橙色)、>2500 RPM(红色)
- 优化硬件信息显示：CPU和GPU卡片现在同时显示温度和风扇转速徽章，提供更直观的硬件状态监控
- 新增风扇转速样式：FanGreen、FanYellow、FanOrange、FanRed四种渐变样式，提升视觉效果
- 完善LibreHardwareMonitor集成：修复风扇传感器识别问题，支持更多风扇传感器名称匹配

v2.1.0 (2025-08-11)
- 修复Windows任务栏图标显示问题：解决添加系统托盘功能后任务栏图标不显示的问题
- 优化图标设置机制：统一使用ip_manager.ico作为主要图标文件，添加窗口类图标设置
- 改进系统托盘功能：确保托盘图标和任务栏图标都能正确显示
- 增强图标兼容性：支持多种图标文件格式和尺寸，提供更好的显示效果
- 完善EXE打包配置：优化PyInstaller配置，确保打包后的EXE文件图标正确显示

v2.0.9 (2025-08-11)
- 为工具区域添加滚动条功能：解决窗口变小时内容显示不全的问题
- 优化工具区域布局：使用Canvas+Scrollbar实现可滚动容器
- 支持鼠标滚轮操作：用户可以通过滚轮或滚动条浏览所有工具功能
- 保持界面整洁性：滚动条只在需要时显示，不影响正常使用体验

v2.0.8 (2025-08-11)
- 最终修复分段按钮文字居中问题：添加sticky=tk.EW参数和toolbar列权重配置
- 优化按钮布局：为toolbar的5列设置equal weight，确保按钮均匀分布
- 完善布局系统：按钮现在能够自适应宽度，文字居中显示效果更佳

v2.0.7 (2025-08-11)
- 正确修复分段按钮文字居中问题：发现程序使用自定义分段按钮而非notebook选项卡，修改Segment.TButton和SegmentSelected.TButton样式
- 添加anchor='center'和justify='center'属性：确保"硬件信息"等按钮文字完全居中显示
- 解决根本问题：之前错误地修改了TNotebook.Tab样式，实际应该修改分段按钮样式

v2.0.6 (2025-08-11)
- 彻底修复选项卡标题居中问题：在notebook创建时立即设置样式，确保TNotebook.Tab样式正确应用
- 增强样式配置：添加justify='center'和更完整的样式映射，确保文字完全居中
- 优化样式应用时机：在notebook创建后立即应用样式，避免样式设置延迟导致的问题

v2.0.5 (2025-08-11)
- 修复选项卡标题居中问题：为TNotebook.Tab样式添加anchor='center'属性，确保所有选项卡标题文字居中显示
- 优化选项卡样式：统一选项卡标题的字体大小和内边距，提升界面美观度
- 改进用户体验：修复硬件信息等选项卡标题显示不居中的问题

v2.0.4 (2025-08-11)
- 优化系统托盘关闭逻辑：第一次关闭时询问用户是关闭程序还是最小化到系统托盘
- 新增关闭确认对话框：提供"是(最小化到托盘)/否(关闭程序)/取消(返回程序)"三个选项
- 改进用户体验：避免用户误操作关闭程序，提供更友好的关闭确认机制
- 智能状态管理：使用first_close_asked标志确保只在第一次关闭时询问

v2.0.3 (2025-08-11)
- 新增"设备和打印机"按钮：在网卡控制区域添加快捷按钮，点击即可打开Windows设备和打印机管理界面
- 优化网卡控制界面布局：采用3列布局重新设计，第一行放置禁用/启用/重置按钮，第二行放置控制面板和设备和打印机按钮
- 改进按钮布局：使用sticky=tk.EW让按钮自适应宽度，提供更好的视觉效果

v2.0.2 (2025-08-11)
- 新增"一键打开网络控制面板"按钮：在网卡控制区域添加快捷按钮，点击即可打开Windows网络连接控制面板（ncpa.cpl）
- 优化网卡控制界面布局：新增按钮与重置网络按钮并排显示，提供更便捷的网络管理体验

v2.0.1 (2025-08-11)
- 新增系统托盘功能：点击右上角X最小化到任务栏，支持单击托盘图标显示窗口，右键菜单包含"显示主窗口"和"退出"
- 优化网络适配器状态显示：准确区分"已禁用"、"未连接"、"已连接"、"连接中"等状态
- 修复网络适配器状态判断逻辑：使用NetConnectionStatus属性进行精确状态判断
- 更新网卡控制功能：禁用/启用网卡功能使用统一的状态判断逻辑
- 优化UI显示：修复获取网络信息时的界面布局问题，使用异步处理避免UI阻塞
- 默认窗口大小调整为 820×750，提供更好的显示体验

v2.0.0 (2025-08-09)
- 新增"硬件信息"子界面：CPU/显卡/内存/硬盘/主板/显示器/系统信息，卡片式布局，支持渐变标题与温度徽章
- 集成 OpenHardwareMonitor（DLL/WMI）：显示温度与风扇转速；提供实时刷新开关与刷新间隔
- 新增"复制信息"按钮：一键复制全部硬件信息文本
- 支持显示器详细信息（名称、厂商、序列号、物理尺寸、分辨率、刷新率）
- UI 现代化：浅色主题、按钮与分段样式重构、标题居中
- 默认窗口大小调整为 600×453（进一步优化1920×1080显示器适配）

v1.3.5 (2025-08-09)
- "网络诊断"新增"网络追踪（tracert）"，默认目标 www.baidu.com，并在新 CMD 窗口执行
- 与"内网测试（ping）/网络测试（ping）"统一布局与样式

v1.3.4 (2025-08-09)
- 启动时自动尝试管理员提权（UAC），避免权限相关功能失败
- 防火墙 ping 规则支持智能判断：优先启用、不存在则自动创建，并校验启用状态
- Win11 自动登录开关：设置后自动打开 netplwiz，便于一键完成配置

v1.3.3 (2025-08-09)
- 工具页重构为"网络诊断/系统工具"分组，布局更清晰
- 新增快速工具：刷新DNS、IP释放、IP续租、Winsock重置、打开防火墙ping
- "一键清理浏览器缓存"纳入系统工具分组，带进度条且不清除账号密码
- 统一子进程调用为静默执行，修复UnicodeDecodeError (gbk) 异常
- 网络测试区域按钮与输入框对齐优化

v1.3.2 (2025-08-09)
- 更换应用图标为可爱的二次元风格，并同步更新窗口内左上角图标
- 右侧布局进一步收窄，左侧保持不变
- 新增内网测试（ping）与外网测试（ping）工具：
  - 内网测试默认取所选网卡的网关地址
  - 点击按钮在新cmd窗口执行 ping <目标> -t

v1.3.1 (2025-08-08)
- 完善IP地址验证功能
- 实时验证IP地址、子网掩码、网关、DNS
- 每个段严格限制在0-255范围内
- 提供详细的错误提示信息
- 优化用户体验和输入安全性

v1.3.0 (2025-08-08)
- 界面字体全面放大（9号→11号）
- 标题字体增大（16号→18号）
- 修复按钮悬停时颜色变化问题
- 优化整体视觉效果和可读性

v1.0.0 (2025-08-08)
- 初始版本发布
- 支持Windows IP地址管理
- 支持网络适配器控制
- 支持静态IP和DHCP配置
- 支持多IP地址配置
- 支持网络重置功能
- 添加版本号显示
"""

def get_version_info():
    """获取版本信息"""
    return {
        'version': VERSION,
        'build_date': BUILD_DATE,
        'build_time': BUILD_TIME,
        'description': VERSION_DESCRIPTION
    }

def get_version_string():
    """获取版本字符串"""
    return f"{VERSION} (更新日期: {BUILD_DATE})"

def get_changelog():
    """获取更新日志"""
    return CHANGELOG

if __name__ == "__main__":
    print(f"版本信息: {get_version_string()}")
    print(f"版本描述: {VERSION_DESCRIPTION}")
    print("\n更新日志:")
    print(CHANGELOG) 